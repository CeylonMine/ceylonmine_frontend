{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/User/Documents/GitHub/ceylonmine_frontend/app/components/LeafletMap.js"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport \"leaflet-gesture-handling/dist/leaflet-gesture-handling.css\";\r\nimport \"leaflet-gesture-handling\";\r\nimport \"leaflet-control-geocoder\";\r\nimport \"leaflet-search\";\r\nimport \"leaflet-search/dist/leaflet-search.min.css\";\r\nimport \"leaflet.fullscreen\";\r\nimport \"leaflet.fullscreen/Control.FullScreen.css\";\r\nimport \"leaflet.markercluster\";\r\nimport \"leaflet.markercluster/dist/MarkerCluster.css\";\r\nimport \"leaflet.markercluster/dist/MarkerCluster.Default.css\";\r\nimport \"./LeafletMap.css\";\r\n\r\nconst LeafletMap = ({ isDarkMode }) => {\r\n  const mapRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    let map = null;\r\n    let markersLayer = null;\r\n\r\n    if (typeof window !== \"undefined\") {\r\n      delete L.Icon.Default.prototype._getIconUrl;\r\n      L.Icon.Default.mergeOptions({\r\n        iconRetinaUrl: \"/images/marker-icon-2x.png\",\r\n        iconUrl: \"/images/marker-icon.png\",\r\n        shadowUrl: \"/images/marker-shadow.png\",\r\n      });\r\n    }\r\n\r\n    const initializeMap = () => {\r\n      if (!mapRef.current || map !== null) return;\r\n\r\n      map = L.map(mapRef.current, {\r\n        zoomControl: false,\r\n        scrollWheelZoom: false,\r\n        gestureHandling: true,\r\n        zoomAnimation: true,\r\n        fadeAnimation: true,\r\n        markerZoomAnimation: true,\r\n        minZoom: 7,\r\n        maxZoom: 18,\r\n      });\r\n\r\n      map.setView([7.8731, 80.7718], 7);\r\n\r\n      const streets = L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n        attribution: \"&copy; OpenStreetMap contributors\",\r\n      });\r\n\r\n      const satellite = L.tileLayer(\r\n        \"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\",\r\n        {\r\n          attribution: \"&copy; Esri & contributors\",\r\n        }\r\n      ).addTo(map);\r\n\r\n      const terrain = L.tileLayer(\"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png\", {\r\n        attribution: \"&copy; OpenTopoMap contributors\",\r\n      });\r\n\r\n      const darkMode = L.tileLayer(\"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\", {\r\n        attribution: \"&copy; OpenStreetMap & CARTO contributors\",\r\n      });\r\n\r\n      L.control.layers(\r\n        { Streets: streets, Satellite: satellite, Terrain: terrain, \"Dark Mode\": darkMode },\r\n        {}\r\n      ).addTo(map);\r\n\r\n      const bounds = L.latLngBounds(L.latLng(5.9167, 79.5167), L.latLng(9.8333, 81.8833));\r\n      map.setMaxBounds(bounds);\r\n\r\n      map.on(\"drag\", () => {\r\n        map.panInsideBounds(bounds, { animate: true, duration: 0.5 });\r\n      });\r\n\r\n      L.control.zoom({ position: \"topright\" }).addTo(map);\r\n      L.control.fullscreen({ position: \"topright\" }).addTo(map);\r\n\r\n      markersLayer = L.markerClusterGroup({\r\n        spiderfyOnMaxZoom: true,\r\n        showCoverageOnHover: false,\r\n        zoomToBoundsOnClick: true,\r\n      }).addTo(map);\r\n\r\n      const createCustomMarker = (location) => {\r\n        const marker = L.marker([location.latitude, location.longitude], {\r\n          icon: L.divIcon({\r\n            className: \"custom-marker\",\r\n            html: `<div class='marker-3d'>üìç</div>`,\r\n            iconSize: [40, 40],\r\n            iconAnchor: [20, 40],\r\n          }),\r\n          title: location.name,\r\n        });\r\n\r\n        const createPopupContent = (isExpanded = false) => `\r\n          <div class=\"custom-popup\">\r\n            <h3>${location.name}</h3>\r\n            <div class=\"popup-description\">${location.description}</div>\r\n            <div class=\"additional-content\" style=\"display: ${isExpanded ? \"block\" : \"none\"}\">\r\n              <p>${location.longDes || \"Additional details not available.\"}</p>\r\n              ${location.image ? `<img src=\"/images/${location.image}\" alt=\"${location.name}\" class=\"popup-image\" />` : \"\"}\r\n            </div>\r\n            <div class=\"popup-buttons\">\r\n              <button class=\"see-more-btn\">${isExpanded ? \"See Less\" : \"See More\"}</button>\r\n              <button class=\"google-maps-btn\">Open in Maps</button>\r\n            </div>\r\n          </div>\r\n        `;\r\n\r\n        marker.bindPopup(createPopupContent(false));\r\n\r\n        marker.on(\"popupopen\", () => {\r\n          const popup = marker.getPopup();\r\n          const popupElement = popup.getElement();\r\n          if (!popupElement) return;\r\n\r\n          const seeMoreBtn = popupElement.querySelector(\".see-more-btn\");\r\n          const googleMapsBtn = popupElement.querySelector(\".google-maps-btn\");\r\n\r\n          if (seeMoreBtn) {\r\n            seeMoreBtn.onclick = () => {\r\n              const isExpanded = seeMoreBtn.textContent === \"See Less\";\r\n              marker.setPopupContent(createPopupContent(!isExpanded));\r\n            };\r\n          }\r\n\r\n          if (googleMapsBtn) {\r\n            googleMapsBtn.onclick = () => {\r\n              window.open(`https://www.google.com/maps?q=${location.latitude},${location.longitude}`, \"_blank\");\r\n            };\r\n          }\r\n        });\r\n\r\n        return marker;\r\n      };\r\n\r\n      const fetchLocations = () => {\r\n        fetch(\"https://ceylonminebackend.up.railway.app/map/get\", {\r\n          method: 'GET',\r\n          headers: {\r\n            'Accept': 'application/json',\r\n          }\r\n        })\r\n          .then((response) => {\r\n            if (!response.ok) throw new Error(\"Network response was not ok\");\r\n            return response.json();\r\n          })\r\n          .then((data) => {\r\n            if (!map || !markersLayer) return;\r\n\r\n            data.forEach((location) => {\r\n              const marker = createCustomMarker(location);\r\n              markersLayer.addLayer(marker);\r\n            });\r\n\r\n            if (map) {\r\n              const searchControl = new L.Control.Search({\r\n                layer: markersLayer,\r\n                propertyName: \"title\",\r\n                initial: false,\r\n                zoom: 12,\r\n                marker: false,\r\n                moveToLocation: (latlng, title, map) => {\r\n                  map.setView(latlng, 14);\r\n                  const targetMarker = markersLayer.getLayers().find((layer) => layer.options.title === title);\r\n                  if (targetMarker) targetMarker.openPopup();\r\n                },\r\n                textPlaceholder: \"üîç Search locations...\",\r\n                position: \"topleft\",\r\n              }).addTo(map);\r\n\r\n              searchControl.on(\"search:locationfound\", (e) => {\r\n                if (!e.layer) return;\r\n\r\n                e.layer.setIcon(\r\n                  L.divIcon({\r\n                    className: \"custom-marker highlighted\",\r\n                    html: `<div class='marker-3d active'>üìç</div>`,\r\n                    iconSize: [50, 50],\r\n                    iconAnchor: [25, 50],\r\n                  })\r\n                );\r\n\r\n                setTimeout(() => {\r\n                  if (e.layer) {\r\n                    e.layer.setIcon(\r\n                      L.divIcon({\r\n                        className: \"custom-marker\",\r\n                        html: `<div class='marker-3d'>üìç</div>`,\r\n                        iconSize: [40, 40],\r\n                        iconAnchor: [20, 40],\r\n                      })\r\n                    );\r\n                  }\r\n                }, 2000);\r\n              });\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            console.error(\"Error fetching locations:\", error);\r\n            if (mapRef.current) {\r\n              const errorMessage = document.createElement(\"div\");\r\n              errorMessage.innerHTML = `<span class=\"error-message\">‚ö†Ô∏è Error loading locations: ${error.message}</span>`;\r\n              mapRef.current.appendChild(errorMessage);\r\n            }\r\n          });\r\n      };\r\n\r\n      if (map) {\r\n        fetchLocations();\r\n      }\r\n\r\n      const handleResize = () => {\r\n        if (map) {\r\n          map.invalidateSize();\r\n        }\r\n      };\r\n\r\n      window.addEventListener(\"resize\", handleResize);\r\n\r\n      setTimeout(() => {\r\n        if (map) {\r\n          map.invalidateSize();\r\n        }\r\n      }, 300);\r\n\r\n      return () => {\r\n        window.removeEventListener(\"resize\", handleResize);\r\n        if (map) {\r\n          map.remove();\r\n          map = null;\r\n        }\r\n        markersLayer = null;\r\n      };\r\n    };\r\n\r\n    const timeout = setTimeout(initializeMap, 100);\r\n\r\n    return () => {\r\n      clearTimeout(timeout);\r\n    };\r\n  }, [isDarkMode]);\r\n\r\n  return (\r\n    <div\r\n      id=\"map\"\r\n      ref={mapRef}\r\n      style={{\r\n        height: \"100%\",\r\n        width: \"100%\",\r\n        borderRadius: \"15px\",\r\n        boxShadow: isDarkMode ? \"0 10px 30px rgba(255,255,255,0.2)\" : \"0 10px 30px rgba(0,0,0,0.2)\",\r\n        position: \"relative\",\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default LeafletMap;"],"names":[],"mappings":"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","debugId":null}}]
}